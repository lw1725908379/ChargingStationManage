/* empty css                *//* empty css                *//* empty css                        *//* empty css                 *//* empty css               */import{_ as V}from"./index.c98eeb74.js";import{_ as Q,B as W,D as X,r as m,b as R,j as _,H as Y,k as s,E as Z,c as ee,R as ae,S as te,e as le,d as oe,a8 as re,a9 as se,af as ne,ag as ie,ah as ce,a6 as pe,ae as de,o as c,f as g,i as a,w as l,F as ue,n as me,l as y,q as b,h as f,a0 as _e,g as D,v as U}from"./index.9456bf99.js";const ge={style:{padding:"6px 6px 0 6px"}},fe={key:0},he={key:1},ve={key:2},we={key:3},ye=["textContent"],be=["textContent"],Se={__name:"list",setup(xe){W().on("refresh",()=>{I()}),X(()=>{I()});const E=m(),S=m(),h=m(),v=m(""),x=m(""),C=m("50%"),i=R({current:1,pageSize:10,total:0}),z=()=>{E.value.resetFields()},e=R({searchParams:{username:"",chargeId:"",state:0},loginUser:{id:"",roleId:1},repairForm:{id:"",description:"",chargeId:"",method:"",state:1},multipleSelection:[],chargeList:[],repairList:[]}),N=()=>{if(e.multipleSelection.length!==1){s.warning("\u8BF7\u9009\u62E9\u4E00\u6761\u6570\u636E\u8FDB\u884C\u7F16\u8F91\uFF01");return}v.value="\u7F16\u8F91\u62A5\u4FEE\u4FE1\u606F",e.repairForm=JSON.parse(JSON.stringify(e.multipleSelection[0])),S.value.openDialog()},L=()=>{if(e.multipleSelection.length!==1){s.warning("\u8BF7\u9009\u62E9\u4E00\u6761\u6570\u636E\u8FDB\u884C\u64A4\u9500\uFF01");return}let t=e.multipleSelection[0];if(t.state!==1){s.warning("\u8BF7\u9009\u62E9\u4E00\u6761\u672A\u53D7\u7406\u7684\u6570\u636E\u8FDB\u884C\u64A4\u9500\uFF01");return}x.value="\u786E\u5B9A\u8981\u64A4\u9500\u6B64\u6570\u636E\u5417\uFF1F",v.value="\u786E\u8BA4\u63D0\u793A",C.value="30%",e.repairForm=JSON.parse(JSON.stringify({...t,method:"cancel"})),h.value.openDialog()},O=()=>{if(e.multipleSelection.length!==1){s.warning("\u8BF7\u9009\u62E9\u4E00\u6761\u6570\u636E\u8FDB\u884C\u5220\u9664\uFF01");return}let t=e.multipleSelection[0];if(t.state===2){s.warning("\u6B64\u62A5\u4FEE\u8FD8\u5728\u53D7\u7406\u4E2D\uFF0C\u7981\u6B62\u5220\u9664\uFF01");return}x.value="\u786E\u5B9A\u8981\u5220\u9664\u6B64\u6570\u636E\u5417\uFF1F",v.value="\u786E\u8BA4\u63D0\u793A",C.value="30%",e.repairForm=JSON.parse(JSON.stringify({...t,method:"delete"})),h.value.openDialog()},I=async()=>{const t=await _("/user/check_login",{token:Y()});t.code===0?(e.loginUser=t.data,d(),q()):(s.error(t.msg),router.push("/login"))},B=async()=>{if(e.repairForm.method==="cancel"){const t=await _("/repair/save",{id:e.repairForm.id,description:e.repairForm.description,chargeId:e.repairForm.chargeId,state:3});t.code===0?(s.success("\u64A4\u9500\u62A5\u4FEE\u6210\u529F\uFF01"),h.value.closeDialog(),d()):s.error(t.msg)}else if(e.repairForm.method==="delete"){const t=await _("/repair/delete",{id:e.repairForm.id});t.code===0?(s.success(t.msg),h.value.closeDialog(),d()):s.error(t.msg)}},J=async()=>{const t=await _("/repair/save",e.repairForm);t.code===0?(s.success(t.msg),S.value.closeDialog(),d()):s.error(t.msg)},T=(t,r)=>{i.current=t,i.pageSize=r,d()},j=t=>{e.multipleSelection=t},q=async()=>{const t=await _("/charge/all");t.code===0?e.chargeList=t.data:s.error(t.msg)},d=async()=>{const t=await _("/repair/list",{page:i.current,size:i.pageSize,param:{username:e.searchParams.username,userId:e.loginUser.roleId===1?e.loginUser.id:"",chargeId:e.searchParams.chargeId,state:e.searchParams.state}});t.code===0?(e.repairList=t.data.list,i.total=t.data.total):s.error(t.msg)};return(t,r)=>{const M=Z,u=ee,n=ae,F=te,w=le,P=oe,k=re,A=se,p=ne,H=ie,$=ce,G=pe,K=de("adaptive");return c(),g("div",ge,[a(G,{class:"card-list",shadow:"never"},{default:l(()=>[a(P,{ref_key:"searchFormRef",ref:E,inline:!0,model:e.searchParams},{default:l(()=>[a(u,{label:"\u7528\u6237\u6635\u79F0",prop:"username"},{default:l(()=>[a(M,{modelValue:e.searchParams.username,"onUpdate:modelValue":r[0]||(r[0]=o=>e.searchParams.username=o),placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u6635\u79F0",style:{width:"200px"}},null,8,["modelValue"])]),_:1}),a(u,{label:"\u5145\u7535\u6869\u540D\u79F0",prop:"chargeId"},{default:l(()=>[a(F,{filterable:"",modelValue:e.searchParams.chargeId,"onUpdate:modelValue":r[1]||(r[1]=o=>e.searchParams.chargeId=o),placeholder:"\u8BF7\u9009\u62E9\u5145\u7535\u6869\u540D\u79F0"},{default:l(()=>[a(n,{label:"\u5168\u90E8",value:0}),(c(!0),g(ue,null,me(e.chargeList,o=>(c(),b(n,{label:o.name,value:o.id,key:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(u,{label:"\u62A5\u4FEE\u72B6\u6001",prop:"state"},{default:l(()=>[a(F,{modelValue:e.searchParams.state,"onUpdate:modelValue":r[2]||(r[2]=o=>e.searchParams.state=o),placeholder:"\u8BF7\u9009\u62E9\u62A5\u4FEE\u72B6\u6001"},{default:l(()=>[a(n,{label:"\u5168\u90E8",value:0}),a(n,{label:"\u672A\u53D7\u7406",value:1}),a(n,{label:"\u5DF2\u53D7\u7406",value:2}),a(n,{label:"\u5DF2\u64A4\u9500",value:3}),a(n,{label:"\u5DF2\u5B8C\u6210",value:4})]),_:1},8,["modelValue"])]),_:1}),a(u,null,{default:l(()=>[a(w,{type:"primary",icon:"search",plain:"",onClick:d},{default:l(()=>[y("\u641C\u7D22")]),_:1}),a(w,{type:"danger",icon:"refresh",plain:"",onClick:z},{default:l(()=>[y("\u91CD\u7F6E")]),_:1})]),_:1})]),_:1},8,["model"]),a(A,{gutter:10},{default:l(()=>[e.loginUser.roleId===2?(c(),b(k,{key:0,span:1.5},{default:l(()=>[a(w,{type:"success",icon:"edit",plain:"",onClick:N},{default:l(()=>[y("\u4FEE\u6539")]),_:1})]),_:1})):f("",!0),a(k,{span:1.5},{default:l(()=>[a(w,{type:"info",icon:"CloseBold",plain:"",onClick:L},{default:l(()=>[y("\u64A4\u9500")]),_:1})]),_:1}),e.loginUser.roleId===2?(c(),b(k,{key:1,span:1.5},{default:l(()=>[a(w,{type:"danger",icon:"delete",plain:"",onClick:O},{default:l(()=>[y("\u5220\u9664")]),_:1})]),_:1})):f("",!0)]),_:1}),_e((c(),b(H,{border:"",onSelectionChange:j,data:e.repairList,"empty-text":"\u6682\u65F6\u6CA1\u67E5\u5230\u6570\u636E\u54DF"},{default:l(()=>[a(p,{type:"selection",width:"55"}),a(p,{label:"\u5E8F\u53F7",prop:"id",width:"140px"}),a(p,{label:"\u5145\u7535\u6869\u540D\u79F0",prop:"chargeName",width:"200px"}),a(p,{label:"\u7528\u6237\u6635\u79F0",prop:"username",width:"150px"}),a(p,{label:"\u62A5\u4FEE\u72B6\u6001",width:"150px"},{default:l(o=>[D("div",null,[o.row.state===1?(c(),g("span",fe,"\u672A\u53D7\u7406")):f("",!0),o.row.state===2?(c(),g("span",he,"\u5DF2\u53D7\u7406")):f("",!0),o.row.state===3?(c(),g("span",ve,"\u5DF2\u64A4\u9500")):f("",!0),o.row.state===4?(c(),g("span",we,"\u5DF2\u5B8C\u6210")):f("",!0)])]),_:1}),a(p,{label:"\u62A5\u4FEE\u65F6\u95F4",prop:"createTime",width:"200px"}),a(p,{prop:"description",label:"\u62A5\u4FEE\u5185\u5BB9\u63CF\u8FF0","show-overflow-tooltip":!0})]),_:1},8,["data"])),[[K]]),a($,{background:"","current-page":i.current,"onUpdate:currentPage":r[3]||(r[3]=o=>i.current=o),"page-size":i.pageSize,"onUpdate:pageSize":r[4]||(r[4]=o=>i.pageSize=o),"page-sizes":[10,20,50,100,200],layout:"total, sizes, prev, pager, next, jumper",total:i.total,onChange:T},null,8,["current-page","page-size","total"])]),_:1}),a(V,{ref_key:"repairDialogRef",ref:S,title:v.value,onOnConfirm:J},{content:l(()=>[a(P,{model:e.repairForm,"label-width":"100px"},{default:l(()=>[a(u,{label:"\u62A5\u4FEE\u7F16\u53F7"},{default:l(()=>[D("div",{textContent:U(e.repairForm.id)},null,8,ye)]),_:1}),a(u,{label:"\u62A5\u4FEE\u72B6\u6001"},{default:l(()=>[a(F,{modelValue:e.repairForm.state,"onUpdate:modelValue":r[5]||(r[5]=o=>e.repairForm.state=o),placeholder:"\u8BF7\u9009\u62E9\u62A5\u4FEE\u72B6\u6001"},{default:l(()=>[a(n,{label:"\u672A\u53D7\u7406",value:1}),a(n,{label:"\u5DF2\u53D7\u7406",value:2}),a(n,{label:"\u5DF2\u64A4\u9500",value:3}),a(n,{label:"\u5DF2\u5B8C\u6210",value:4})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title"]),a(V,{ref_key:"confirmDialogRef",ref:h,width:C.value,title:v.value,onOnConfirm:B},{content:l(()=>[D("div",{style:{display:"flex","justify-content":"center","font-size":"16px"},textContent:U(x.value)},null,8,be)]),_:1},8,["width","title"])])}}};var Re=Q(Se,[["__scopeId","data-v-5e036fc4"]]);export{Re as default};
